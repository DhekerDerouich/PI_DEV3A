<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.Priority?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.shape.Circle?>

<VBox styleClass="main-container" spacing="0.0"
      VBox.vgrow="ALWAYS"
      stylesheets="@styles.css"
      xmlns="http://javafx.com/javafx/17"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="tn.esprit.farmvision.com.pi.controller.MaintenanceController">

    <children>
        <!-- Page Header - Hauteur fixe -->
        <HBox style="-fx-background-color: white; -fx-border-color: #EFEFEF; -fx-border-width: 0 0 1 0; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.07), 6, 0, 0, 2);"
              spacing="15.0" alignment="CENTER_LEFT" VBox.vgrow="NEVER">
            <padding><Insets left="30.0" right="30.0" top="18.0" bottom="18.0" /></padding>
            <children>
                <StackPane HBox.hgrow="NEVER">
                    <children>
                        <Circle radius="28.0" style="-fx-fill: linear-gradient(to bottom right, #5BAD6F, #43A047);" />
                        <Label text="ðŸ”§" style="-fx-font-size: 24px;" />
                    </children>
                </StackPane>
                <VBox spacing="3.0" HBox.hgrow="NEVER">
                    <children>
                        <Label text="Gestion des Maintenances" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #1B1B1B;" />
                        <Label text="Planifiez, suivez et optimisez toutes vos opÃ©rations de maintenance" style="-fx-font-size: 12px; -fx-text-fill: #757575;" />
                        <Label fx:id="infoSolaireLabel" style="-fx-text-fill: #FF9800; -fx-font-weight: bold; -fx-font-size: 11px;" />
                    </children>
                </VBox>
                <Region HBox.hgrow="ALWAYS" />
                <HBox spacing="10.0" alignment="CENTER" HBox.hgrow="NEVER">
                    <children>
                        <Button text="ðŸ“… Calendrier" onAction="#ouvrirCalendrierMaintenance"
                                style="-fx-background-color: #2D5A3D; -fx-text-fill: white; -fx-background-radius: 8; -fx-padding: 10 16; -fx-font-size: 13px; -fx-font-weight: bold; -fx-cursor: hand;" />
                        <Button text="ðŸ”„ Actualiser" onAction="#refreshTable"
                                style="-fx-background-color: #2D5A3D; -fx-text-fill: white; -fx-background-radius: 8; -fx-padding: 10 16; -fx-font-size: 13px; -fx-font-weight: bold; -fx-cursor: hand;" />
                        <Button text="âž• Planifier" onAction="#showAddDialog"
                                style="-fx-background-color: #5BAD6F; -fx-text-fill: white; -fx-background-radius: 8; -fx-padding: 10 16; -fx-font-size: 13px; -fx-font-weight: bold; -fx-cursor: hand;" />
                        <Button text="ðŸ“Š Stats" onAction="#showStats"
                                style="-fx-background-color: #F0F2F0; -fx-text-fill: #555; -fx-border-color: #D5D5D5; -fx-border-width: 1; -fx-border-radius: 8; -fx-background-radius: 8; -fx-padding: 10 16; -fx-font-size: 13px; -fx-cursor: hand;" />
                    </children>
                </HBox>
            </children>
        </HBox>

        <!-- Scrollable content - Prend tout l'espace restant -->
        <ScrollPane fitToWidth="true" fitToHeight="true"
                    style="-fx-background-color: #F5F7F5; -fx-background: #F5F7F5;"
                    VBox.vgrow="ALWAYS">
            <content>
                <VBox spacing="20.0" style="-fx-padding: 25 30 30 30; -fx-background-color: #F5F7F5;"
                      VBox.vgrow="ALWAYS">
                    <children>
                        <!-- Filters Panel - Hauteur fixe -->
                        <VBox spacing="15.0" VBox.vgrow="NEVER"
                              style="-fx-background-color: white; -fx-background-radius: 14; -fx-padding: 22; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.07), 10, 0, 0, 3);">
                            <children>
                                <HBox alignment="CENTER_LEFT" spacing="8.0">
                                    <children>
                                        <Label text="ðŸ”" style="-fx-font-size: 18px;" />
                                        <Label text="Filtres" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #1B1B1B;" />
                                    </children>
                                </HBox>
                                <HBox alignment="CENTER_LEFT" spacing="15.0" HBox.hgrow="ALWAYS">
                                    <children>
                                        <VBox spacing="5.0" HBox.hgrow="ALWAYS" maxWidth="Infinity">
                                            <children>
                                                <Label text="Statut" style="-fx-font-size: 13px; -fx-font-weight: 600; -fx-text-fill: #333;" />
                                                <ComboBox fx:id="filterStatut" maxWidth="Infinity" promptText="Tous"
                                                          style="-fx-background-color: #F5F7F5; -fx-border-color: #DCDCDC; -fx-border-width: 1; -fx-border-radius: 9; -fx-background-radius: 9; -fx-padding: 8; -fx-font-size: 13px;" />
                                            </children>
                                        </VBox>
                                        <VBox spacing="5.0" HBox.hgrow="ALWAYS" maxWidth="Infinity">
                                            <children>
                                                <Label text="Ã‰quipement" style="-fx-font-size: 13px; -fx-font-weight: 600; -fx-text-fill: #333;" />
                                                <ComboBox fx:id="filterEquipement" maxWidth="Infinity" promptText="Tous les Ã©quipements"
                                                          style="-fx-background-color: #F5F7F5; -fx-border-color: #DCDCDC; -fx-border-width: 1; -fx-border-radius: 9; -fx-background-radius: 9; -fx-padding: 8; -fx-font-size: 13px;" />
                                            </children>
                                        </VBox>
                                        <VBox spacing="5.0" alignment="BOTTOM_LEFT" HBox.hgrow="NEVER">
                                            <children>
                                                <Label text=" " />
                                                <Button text="âŒ Effacer" onAction="#clearFilters"
                                                        style="-fx-background-color: #F0F2F0; -fx-text-fill: #555; -fx-border-color: #D5D5D5; -fx-border-width: 1; -fx-border-radius: 8; -fx-background-radius: 8; -fx-padding: 10 16; -fx-cursor: hand;" />
                                            </children>
                                        </VBox>
                                    </children>
                                </HBox>
                            </children>
                        </VBox>

                        <!-- Stats Cards - Hauteur fixe -->
                        <HBox spacing="15.0" VBox.vgrow="NEVER">
                            <children>
                                <!-- Total â€” vert foncÃ© -->
                                <VBox spacing="8.0" alignment="CENTER" HBox.hgrow="ALWAYS" minHeight="130.0" maxHeight="130.0"
                                      style="-fx-background-color: linear-gradient(135deg, #2D5A3D, #3D7A52); -fx-background-radius: 12; -fx-padding: 20 15; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 8, 0, 0, 2);">
                                    <children>
                                        <Label text="ðŸ“‹" style="-fx-font-size: 30px;" />
                                        <Label fx:id="totalLabel" text="0" style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: black;" />
                                        <Label text="Total" style="-fx-font-size: 12px; -fx-text-fill: rgba(0, 0, 0, 1);" />
                                    </children>
                                </VBox>
                                <!-- PlanifiÃ©es â€” bordure orange -->
                                <VBox spacing="8.0" alignment="CENTER" HBox.hgrow="ALWAYS" minHeight="130.0" maxHeight="130.0"
                                      style="-fx-background-color: white; -fx-background-radius: 12; -fx-border-color: #FF9800; -fx-border-width: 2; -fx-border-radius: 12; -fx-padding: 20 15; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.07), 8, 0, 0, 2);">
                                    <children>
                                        <Label text="ðŸ“…" style="-fx-font-size: 30px;" />
                                        <Label fx:id="planifieesLabel" text="0" style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #FF9800;" />
                                        <Label text="PlanifiÃ©es" style="-fx-font-size: 12px; -fx-text-fill: #757575;" />
                                    </children>
                                </VBox>
                                <!-- RÃ©alisÃ©es â€” bordure verte -->
                                <VBox spacing="8.0" alignment="CENTER" HBox.hgrow="ALWAYS" minHeight="130.0" maxHeight="130.0"
                                      style="-fx-background-color: white; -fx-background-radius: 12; -fx-border-color: #43A047; -fx-border-width: 2; -fx-border-radius: 12; -fx-padding: 20 15; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.07), 8, 0, 0, 2);">
                                    <children>
                                        <Label text="âœ…" style="-fx-font-size: 30px;" />
                                        <Label fx:id="realiseesLabel" text="0" style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #43A047;" />
                                        <Label text="RÃ©alisÃ©es" style="-fx-font-size: 12px; -fx-text-fill: #757575;" />
                                    </children>
                                </VBox>
                                <!-- CoÃ»t Total â€” gradient vert clair -->
                                <VBox spacing="8.0" alignment="CENTER" HBox.hgrow="ALWAYS" minHeight="130.0" maxHeight="130.0"
                                      style="-fx-background-color: linear-gradient(135deg, #8BC34A, #43A047); -fx-background-radius: 12; -fx-padding: 20 15; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 8, 0, 0, 2);">
                                    <children>
                                        <Label text="ðŸ’°" style="-fx-font-size: 30px;" />
                                        <Label fx:id="coutTotalLabel" text="0.00 DT" style="-fx-font-size: 22px; -fx-font-weight: bold; -fx-text-fill: black;" />
                                        <Label text="CoÃ»t Total" style="-fx-font-size: 12px; -fx-text-fill: rgba(0, 0, 0, 1);" />
                                    </children>
                                </VBox>
                            </children>
                        </HBox>

                        <!-- Table Panel - Prend tout l'espace restant -->
                        <VBox spacing="12.0" VBox.vgrow="ALWAYS"
                              style="-fx-background-color: white; -fx-background-radius: 14; -fx-padding: 22; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.07), 10, 0, 0, 3);">
                            <children>
                                <Label text="ðŸ“‹ Liste des Maintenances"
                                       style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #1B1B1B;"
                                       VBox.vgrow="NEVER"/>
                                <TableView fx:id="maintenanceTable" styleClass="modern-table"
                                           VBox.vgrow="ALWAYS"
                                           prefHeight="450.0"
                                           minHeight="200.0">
                                    <columns>
                                        <TableColumn fx:id="colEquipementNom" text="Ã‰quipement" prefWidth="160" minWidth="120" />
                                        <TableColumn fx:id="colType" text="Type" prefWidth="100" minWidth="80" />
                                        <TableColumn fx:id="colDescription" text="Description" prefWidth="200" minWidth="150" />
                                        <TableColumn fx:id="colDate" text="Date" prefWidth="90" minWidth="70" />
                                        <TableColumn fx:id="colCout" text="CoÃ»t (DT)" prefWidth="100" minWidth="80" />
                                        <TableColumn fx:id="colStatut" text="Statut" prefWidth="100" minWidth="80" />
                                        <TableColumn fx:id="colActions" text="Actions" prefWidth="290" minWidth="250" maxWidth="350" />
                                        <TableColumn fx:id="colMeilleurePeriode" text="â˜€ï¸ PÃ©riode" prefWidth="120" minWidth="100" />
                                    </columns>
                                    <columnResizePolicy>
                                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                    </columnResizePolicy>
                                </TableView>
                            </children>
                        </VBox>
                    </children>
                </VBox>
            </content>
        </ScrollPane>
    </children>
</VBox>