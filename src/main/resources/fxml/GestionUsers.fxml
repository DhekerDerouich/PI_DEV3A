<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.control.cell.*?>
<?import javafx.scene.layout.*?>

<BorderPane fx:id="rootPane" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="tn.esprit.farmvision.gestionuser.controller.GestionUsersControllerFX"
            style="-fx-background-color: #f8f9fa;">

    <padding><Insets top="20" right="20" bottom="20" left="20"/></padding>

    <top>
        <VBox spacing="15">
            <!-- Header avec bouton retour -->
            <HBox alignment="CENTER_LEFT" spacing="20">
                <Button text="â† Retour Dashboard" fx:id="btnRetour" onAction="#handleRetour"
                        style="-fx-background-color: #6c757d; -fx-text-fill: white; -fx-padding: 10 20; -fx-font-weight: bold;"/>
                <Label text="Gestion des Utilisateurs" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #0d6efd;" HBox.hgrow="ALWAYS"/>
            </HBox>

            <!-- Barre de recherche -->
            <HBox spacing="15">
                <TextField fx:id="txtSearch" promptText="ðŸ”Ž Recherche en temps rÃ©el (nom, prÃ©nom, email)..." prefWidth="400"/>
                <ComboBox fx:id="cbFilterRole" promptText="Filtrer par rÃ´le" prefWidth="200"/>
                <Label text="ðŸ’¡ La recherche est automatique !" style="-fx-text-fill: #198754; -fx-font-weight: bold;"/>
            </HBox>
        </VBox>
    </top>

    <center>
        <!-- âœ… Tableau avec colonne Remarques -->
        <TableView fx:id="tableUsers" VBox.vgrow="ALWAYS">
            <columns>
                <TableColumn fx:id="colNom" text="Nom" prefWidth="110"/>
                <TableColumn fx:id="colPrenom" text="PrÃ©nom" prefWidth="110"/>
                <TableColumn fx:id="colEmail" text="Email" prefWidth="200"/>
                <TableColumn fx:id="colRole" text="RÃ´le" prefWidth="150" style="-fx-alignment: CENTER;"/>
                <TableColumn fx:id="colDetails" text="ðŸ“‹ DÃ©tails" prefWidth="220"/>

                <!-- âœ… NOUVELLE COLONNE: Remarques -->
                <TableColumn fx:id="colRemarques" text="ðŸ’¬ Remarques" prefWidth="200" style="-fx-alignment: CENTER_LEFT;"/>

                <TableColumn fx:id="colPassword" text="ðŸ”‘ MDP" prefWidth="130" style="-fx-alignment: CENTER;"/>
                <TableColumn fx:id="colActivated" text="ActivÃ©" prefWidth="80" style="-fx-alignment: CENTER;"/>
                <TableColumn fx:id="colDateCreation" text="Date crÃ©ation" prefWidth="120" style="-fx-alignment: CENTER;"/>
            </columns>

            <placeholder>
                <VBox alignment="CENTER" spacing="10" style="-fx-padding: 40;">
                    <Label text="ðŸ“‹" style="-fx-font-size: 40px;"/>
                    <Label text="Aucun utilisateur trouvÃ©" style="-fx-font-size: 16px; -fx-text-fill: #999999;"/>
                    <Label text="Ajoutez votre premier utilisateur ou modifiez les filtres" style="-fx-font-size: 12px; -fx-text-fill: #cccccc;"/>
                </VBox>
            </placeholder>
        </TableView>
    </center>

    <bottom>
        <VBox spacing="15">
            <!-- Boutons CRUD -->
            <HBox spacing="15" alignment="CENTER_RIGHT">
                <Button text="âž• Ajouter" fx:id="btnAdd" onAction="#handleAddUser"
                        style="-fx-background-color: #198754; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 12 30;"/>
                <Button text="âœï¸ Modifier" fx:id="btnEdit" onAction="#handleEdit" disable="true"
                        style="-fx-background-color: #0d6efd; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 12 30;"/>
                <Button text="ðŸ—‘ï¸ Supprimer" fx:id="btnDelete" onAction="#handleDelete" disable="true"
                        style="-fx-background-color: #dc3545; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 12 30;"/>
                <Button text="âœ… Valider" fx:id="btnValidate" onAction="#handleValidate" disable="true"
                        style="-fx-background-color: #ffc107; -fx-text-fill: black; -fx-font-weight: bold; -fx-padding: 12 30;"/>
            </HBox>

            <Label fx:id="lblMessage" style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
        </VBox>
    </bottom>

</BorderPane>
