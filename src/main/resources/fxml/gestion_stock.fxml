<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.shape.Circle?>
<?import javafx.geometry.Insets?>

<BorderPane maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity"
            prefHeight="800.0" prefWidth="1400.0"
            stylesheets="@/css/style.css"
            xmlns="http://javafx.com/javafx/17.0.2-ea"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="tn.esprit.farmvision.gestionstock.controller.StockController">

    <!-- SIDEBAR GAUCHE -->
    <left>
        <VBox prefHeight="800.0" prefWidth="280.0" styleClass="sidebar" BorderPane.alignment="CENTER">
            <children>
                <!-- Logo Section -->
                <HBox alignment="CENTER_LEFT" spacing="15.0" styleClass="logo-container">
                    <padding>
                        <Insets bottom="30.0" left="25.0" right="25.0" top="30.0" />
                    </padding>
                    <children>
                        <StackPane styleClass="logo-icon-container">
                            <children>
                                <Circle radius="28.0" styleClass="logo-circle" />
                                <Label text="ðŸŒ¾" styleClass="logo-emoji" />
                            </children>
                        </StackPane>
                        <VBox spacing="2.0">
                            <children>
                                <Label text="FarmVision" styleClass="logo-title" />
                                <Label text="Gestion Agricole" styleClass="logo-subtitle" />
                            </children>
                        </VBox>
                    </children>
                </HBox>

                <!-- Navigation -->
                <VBox spacing="8.0" styleClass="nav-container">
                    <padding>
                        <Insets left="20.0" right="20.0" />
                    </padding>
                    <children>
                        <Label text="ðŸ“Œ NAVIGATION" styleClass="section-title" />

                        <!-- Bouton Stocks (actif) -->
                        <Button fx:id="btnStocks" styleClass="nav-button-active" text="ðŸ“¦ Gestion des Stocks"
                                onAction="#handleStocks" prefWidth="240.0" alignment="CENTER_LEFT">
                            <graphic>
                                <Label text="ðŸŒ½" styleClass="nav-icon" />
                            </graphic>
                        </Button>

                        <!-- Bouton Marketplace -->
                        <Button fx:id="btnMarketplace" styleClass="nav-button" text="ðŸ›’ Marketplace"
                                onAction="#handleMarketplace" prefWidth="240.0" alignment="CENTER_LEFT">
                            <graphic>
                                <Label text="ðŸ›’" styleClass="nav-icon" />
                            </graphic>
                        </Button>
                    </children>
                </VBox>

                <!-- Statistiques -->
                <VBox spacing="15.0" styleClass="stats-container">
                    <padding>
                        <Insets left="20.0" right="20.0" top="20.0" />
                    </padding>
                    <children>
                        <Label text="ðŸ“Š APERÃ‡U STOCKS" styleClass="section-title" />

                        <HBox styleClass="stat-card" alignment="CENTER_LEFT" spacing="10.0">
                            <Label text="ðŸ“¦" styleClass="stat-icon" />
                            <VBox>
                                <Label text="Total Produits" styleClass="stat-label" />
                                <Label fx:id="lblTotalProduits" text="0" styleClass="stat-value" />
                            </VBox>
                        </HBox>

                        <HBox styleClass="stat-card" alignment="CENTER_LEFT" spacing="10.0">
                            <Label text="âœ…" styleClass="stat-icon" />
                            <VBox>
                                <Label text="Disponibles" styleClass="stat-label" />
                                <Label fx:id="lblDisponibles" text="0" styleClass="stat-value" />
                            </VBox>
                        </HBox>

                        <HBox styleClass="stat-card" alignment="CENTER_LEFT" spacing="10.0">
                            <Label text="âš ï¸" styleClass="stat-icon" />
                            <VBox>
                                <Label text="BientÃ´t ExpirÃ©s" styleClass="stat-label" />
                                <Label fx:id="lblBientotExpires" text="0" styleClass="stat-value-warning" />
                            </VBox>
                        </HBox>
                    </children>
                </VBox>

                <!-- Actions Rapides -->
                <VBox spacing="10.0" styleClass="quick-actions">
                    <padding>
                        <Insets left="20.0" right="20.0" top="20.0" />
                    </padding>
                    <children>
                        <Label text="âš¡ ACTIONS RAPIDES" styleClass="section-title" />

                        <Button mnemonicParsing="false" onAction="#handleAjouterStock" styleClass="action-button" text="Ajouter stock">
                            <graphic><Label text="âž•" styleClass="button-icon" /></graphic>
                        </Button>

                        <Button mnemonicParsing="false" onAction="#handleAnalysePrevision" styleClass="action-button" text="Analyse">
                            <graphic><Label text="ðŸ“Š" styleClass="button-icon" /></graphic>
                        </Button>

                        <Button mnemonicParsing="false" onAction="#handleControleQualite" styleClass="action-button" text="ContrÃ´le">
                            <graphic><Label text="ðŸ”" styleClass="button-icon" /></graphic>
                        </Button>
                    </children>
                </VBox>

                <!-- User Card (Bottom) -->
                <VBox alignment="BOTTOM_CENTER" VBox.vgrow="ALWAYS">
                    <padding>
                        <Insets bottom="30.0" left="20.0" right="20.0" top="20.0" />
                    </padding>
                    <children>
                        <HBox styleClass="user-card" alignment="CENTER_LEFT" spacing="12.0">
                            <padding>
                                <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
                            </padding>
                            <children>
                                <StackPane>
                                    <Circle radius="20.0" styleClass="user-avatar" />
                                    <Label text="ðŸ‘¨â€ðŸŒ¾" />
                                </StackPane>
                                <VBox>
                                    <Label text="Agriculteur" styleClass="user-name" />
                                    <Label text="ConnectÃ©" styleClass="user-status" />
                                </VBox>
                            </children>
                        </HBox>
                    </children>
                </VBox>
            </children>
        </VBox>
    </left>

    <!-- CONTENU PRINCIPAL CENTRE -->
    <center>
        <StackPane prefHeight="800.0" prefWidth="1120.0" styleClass="content-area" BorderPane.alignment="CENTER">
            <padding>
                <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
            </padding>

            <VBox spacing="20.0">
                <children>
                    <!-- Header avec titre et recherche -->
                    <HBox alignment="CENTER_LEFT" spacing="20.0">
                        <children>
                            <VBox>
                                <Label text="ðŸŒ½ Gestion des Stocks" styleClass="page-title" />
                                <Label text="GÃ©rez vos rÃ©coltes et productions" styleClass="page-subtitle" />
                            </VBox>
                            <HBox spacing="10.0" HBox.hgrow="ALWAYS" alignment="CENTER_RIGHT">
                                <TextField fx:id="txtRecherche" promptText="Rechercher un produit..." styleClass="search-field" prefWidth="250.0" />
                                <ComboBox fx:id="comboFiltreCategorie" promptText="CatÃ©gorie" styleClass="filter-combo" prefWidth="130.0" />
                                <ComboBox fx:id="comboFiltreStatut" promptText="Statut" styleClass="filter-combo" prefWidth="120.0" />
                                <Button onAction="#handleRafraichir" styleClass="refresh-button" text="â†»" />
                            </HBox>
                        </children>
                    </HBox>

                    <!-- Tableau des stocks -->
                    <TableView fx:id="stockTable" styleClass="modern-table" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colId" prefWidth="50.0" text="ID" />
                            <TableColumn fx:id="colProduit" prefWidth="150.0" text="Produit" />
                            <TableColumn fx:id="colCategorie" prefWidth="120.0" text="Type" />
                            <TableColumn fx:id="colQuantite" prefWidth="80.0" text="QuantitÃ©" />
                            <TableColumn fx:id="colUnite" prefWidth="80.0" text="UnitÃ©" />
                            <TableColumn fx:id="colDate" prefWidth="100.0" text="Date EntrÃ©e" />
                            <TableColumn fx:id="colDateExpiration" prefWidth="100.0" text="Expiration" />
                            <TableColumn fx:id="colStatut" prefWidth="80.0" text="Statut" />
                        </columns>
                    </TableView>

                    <!-- Message d'information -->
                    <Label fx:id="lblMessage" styleClass="info-message" text="" />

                    <!-- Barre d'actions SIMPLIFIÃ‰E -->
                    <HBox spacing="10.0" alignment="CENTER" styleClass="action-bar">
                        <children>
                            <Button onAction="#handleAjouterStock" styleClass="btn-primary" text="âž• Ajouter" />
                            <Button onAction="#handleModifierStock" styleClass="btn-secondary" text="âœï¸ Modifier" />
                            <Button onAction="#handleSupprimerStock" styleClass="btn-danger" text="ðŸ—‘ï¸ Supprimer" />
                            <Button onAction="#handleVoirDetails" styleClass="btn-info" text="ðŸ“‹ DÃ©tails" />
                            <Button onAction="#handleExporterPDF" styleClass="btn-gray" text="ðŸ“„ PDF" />
                            <Button onAction="#handleImprimer" styleClass="btn-gray" text="ðŸ–¨ï¸ Imprimer" />
                            <Button onAction="#handleRetour" styleClass="btn-gray" text="â†©ï¸ Retour" />
                        </children>
                    </HBox>
                </children>
            </VBox>
        </StackPane>
    </center>
</BorderPane>